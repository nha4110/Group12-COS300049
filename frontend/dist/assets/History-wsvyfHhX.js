import{r as c,j as s,m as x,P as y,T as t,V as w,W as A,B as g,d as k,b as C,a as E,C as F,X as $}from"./index-BaiZDlTz.js";import{T as H,a as v}from"./Tabs-COGSINym.js";const I=()=>{const[i,a]=c.useState([]),[d,u]=c.useState({});c.useEffect(()=>{const e=JSON.parse(localStorage.getItem("balanceTransactions"))||[];a(e.reverse())},[]);const b=e=>{u(r=>({...r,[e]:!r[e]}))};return s.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:s.jsxs(y,{elevation:4,sx:{p:4,borderRadius:3,background:"linear-gradient(135deg, #f9f9f9, #e8ecef)",boxShadow:"0 6px 18px rgba(0, 0, 0, 0.08)"},children:[s.jsx(t,{variant:"h5",sx:{fontWeight:"bold",color:"#2c3e50",mb:2},children:"Balance Transactions History "}),s.jsx(w,{children:i.length>0?i.map((e,r)=>s.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:r*.1},children:s.jsx(y,{elevation:2,sx:{p:3,mb:2,borderRadius:2,background:"#fff","&:hover":{boxShadow:"0 4px 20px rgba(110, 142, 251, 0.3)"}},children:s.jsxs(A,{sx:{display:"block"},children:[s.jsxs(t,{variant:"h6",sx:{fontWeight:"bold",color:"#2c3e50"},children:["Sent ",e.amount||"N/A"," ETH "]}),s.jsxs(g,{sx:{mt:1},children:[s.jsxs(t,{variant:"body1",sx:{color:"#34495e"},children:[s.jsx("strong",{style:{color:"#16a085"},children:"From:"})," ",e.sender?`${e.sender.substring(0,6)}...${e.sender.substring(e.sender.length-4)}`:"N/A"]}),s.jsxs(t,{variant:"body1",sx:{color:"#34495e"},children:[s.jsx("strong",{style:{color:"#c0392b"},children:"To:"})," ",e.recipient?`${e.recipient.substring(0,6)}...${e.recipient.substring(e.recipient.length-4)}`:"N/A"]}),s.jsxs(t,{variant:"body2",sx:{mt:1,color:"#6e8efb",cursor:"pointer",textDecoration:"underline"},onClick:()=>b(r),children:[s.jsx("strong",{children:"Tx Hash:"})," ",e.hash?d[r]?`${e.hash.substring(0,6)}...${e.hash.substring(e.hash.length-4)}`:"Click to show":"N/A"]}),s.jsxs(t,{variant:"body2",sx:{color:"#34495e"},children:[s.jsx("strong",{children:"Date:"})," ",e.date?new Date(e.date).toLocaleString():"N/A"]}),s.jsxs(t,{variant:"body2",sx:{color:"#34495e"},children:[s.jsx("strong",{children:"Gas:"})," ",e.gas||"N/A"," ETH"]})]})]})})},r)):s.jsx(t,{variant:"body1",sx:{textAlign:"center",color:"#7f8c8d"},children:"No balance transactions found. "})})]})})},P="http://localhost:8081",W=()=>{const{state:i}=k(),a=i.user,[d,u]=c.useState([]),[b,e]=c.useState({}),[r,p]=c.useState(null),[N,j]=c.useState(!0),l=(a==null?void 0:a.walletAddress)||(a==null?void 0:a.wallet_address)||(a==null?void 0:a.wallet);c.useEffect(()=>{if(!l){p("No wallet address available. Please log in."),j(!1);return}const n=async()=>{var m,T;try{const h=localStorage.getItem("jwtToken");if(!h)throw new Error("No JWT token found. Please log in.");console.log(`Fetching NFT transactions for wallet: ${l}`);const f=await E.get(`${P}/api/nft-transactions`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}});if(console.log("API response data:",JSON.stringify(f.data,null,2)),f.data&&Array.isArray(f.data))u(f.data),p(null);else throw new Error("Invalid response format from API")}catch(h){console.error("Error fetching NFT transactions:",h.message),p(((T=(m=h.response)==null?void 0:m.data)==null?void 0:T.message)||h.message||"Failed to fetch transactions")}finally{j(!1)}};n();const o=()=>{console.log("NFT transaction updated, refetching..."),n()};return window.addEventListener("nftTransactionUpdated",o),()=>{window.removeEventListener("nftTransactionUpdated",o)}},[l]);const S=n=>{e(o=>({...o,[n]:!o[n]}))};return a?s.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:s.jsxs(y,{elevation:4,sx:{p:4,borderRadius:3,background:"linear-gradient(135deg, #f9f9f9, #e8ecef)",boxShadow:"0 6px 18px rgba(0, 0, 0, 0.08)"},children:[s.jsx(t,{variant:"h5",sx:{fontWeight:"bold",color:"#2c3e50",mb:2},children:"NFT Transactions History "}),s.jsxs(t,{variant:"body1",sx:{color:"#34495e",mb:3},children:["Wallet Address: ",l?`${l.substring(0,6)}...${l.substring(l.length-4)}`:"Not set"]}),N?s.jsxs(g,{sx:{display:"flex",justifyContent:"center",my:4},children:[s.jsx(C,{color:"primary"})," "]}):r?s.jsxs(t,{variant:"body1",sx:{color:"error.main",textAlign:"center"},children:[r," "]}):s.jsx(w,{children:d.length>0?d.map((n,o)=>s.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:o*.1},children:s.jsx(y,{elevation:2,sx:{p:3,mb:2,borderRadius:2,background:"#fff","&:hover":{boxShadow:"0 4px 20px rgba(110, 142, 251, 0.3)"}},children:s.jsxs(A,{sx:{display:"block"},children:[s.jsxs(t,{variant:"h6",sx:{fontWeight:"bold",color:"#2c3e50"},children:[n.transaction_type==="Purchase"?"Purchased":"Transferred"," ",n.nft_name||"Unknown NFT"," (Token ID: ",n.token_id,")"]}),s.jsxs(g,{sx:{mt:1},children:[s.jsxs(t,{variant:"body1",sx:{color:"#34495e"},children:[s.jsx("strong",{style:{color:"#16a085"},children:"From:"})," ",n.from.substring(0,6),"...",n.from.substring(n.from.length-4)]}),s.jsxs(t,{variant:"body1",sx:{color:"#34495e"},children:[s.jsx("strong",{style:{color:"#c0392b"},children:"To:"})," ",n.to.substring(0,6),"...",n.to.substring(n.to.length-4)]}),s.jsxs(t,{variant:"body1",sx:{color:"#34495e"},children:[s.jsx("strong",{style:{color:"#8e44ad"},children:"Amount:"})," ",n.amount," ETH"]}),s.jsxs(t,{variant:"body2",sx:{mt:1,color:"#6e8efb",cursor:"pointer",textDecoration:"underline"},onClick:()=>S(o),children:[s.jsx("strong",{children:"Tx Hash:"})," ",b[o]?`${n.tx_hash.substring(0,6)}...${n.tx_hash.substring(n.tx_hash.length-4)}`:"Click to show"]}),s.jsxs(t,{variant:"body2",sx:{color:"#34495e"},children:[s.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleString()," "]})]})]})})},o)):s.jsx(t,{variant:"body1",sx:{textAlign:"center",color:"#7f8c8d"},children:"No NFT transactions found. "})})]})}):s.jsx(t,{variant:"h6",color:"error",sx:{textAlign:"center",mt:4},children:"Unauthorized Access "})},_=()=>{const[i,a]=c.useState(0),d=(u,b)=>{a(b)};return s.jsx(F,{maxWidth:"md",sx:{mt:6,mb:4},children:s.jsxs(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8},children:[s.jsxs(g,{sx:{background:"linear-gradient(135deg, #6e8efb, #a777e3)",borderRadius:3,p:4,textAlign:"center",color:"white",mb:4,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)"},children:[s.jsxs(t,{variant:"h3",sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[s.jsx($,{})," Transaction History"]}),s.jsx(t,{variant:"body1",sx:{mt:1},children:"Review your past NFT and balance transactions."})]}),s.jsxs(H,{value:i,onChange:d,centered:!0,sx:{bgcolor:"#ffffff",borderRadius:2,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.05)","& .MuiTab-root":{textTransform:"none",fontWeight:"bold",fontSize:"1.1rem",color:"#7f8c8d","&.Mui-selected":{color:"#6e8efb"}},"& .MuiTabs-indicator":{backgroundColor:"#6e8efb",height:3}},children:[s.jsx(v,{label:"NFT Transactions"}),s.jsx(v,{label:"Balance Transactions"})]}),s.jsx(x.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.5},children:s.jsxs(g,{sx:{mt:3},children:[i===0&&s.jsx(W,{}),i===1&&s.jsx(I,{})]})},i)]})})};export{_ as default};
