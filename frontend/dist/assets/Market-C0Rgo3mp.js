import{n as se,q as re,r as p,t as oe,$ as Ae,P as me,a1 as pe,O as Ne,U as G,w as Y,s as U,j as n,z as O,E as ie,a2 as Ee,a3 as Ie,y as ge,T as h,c as he,a as E,h as le,a4 as de,e as z,f as ae,G as q,m as ce,B as I,p as ue,a5 as Pe,u as We,d as Be,C as Oe,b as Ue}from"./index-BaiZDlTz.js";import{C as _e,a as He,b as Le}from"./CardMedia-f9LVn6NY.js";import{B as V}from"./Button-aGJUPGZF.js";function Ge(e){return re("MuiDialog",e)}const te=se("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),fe=p.createContext({}),ze=U(Ie,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Ye=e=>{const{classes:t,scroll:a,maxWidth:s,fullWidth:r,fullScreen:u}=e,l={root:["root"],container:["container",`scroll${O(a)}`],paper:["paper",`paperScroll${O(a)}`,`paperWidth${O(String(s))}`,r&&"paperFullWidth",u&&"paperFullScreen"]};return ie(l,Ge,t)},qe=U(Ee,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Xe=U("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.container,t[`scroll${O(a.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Je=U(me,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.paper,t[`scrollPaper${O(a.scroll)}`],t[`paperWidth${O(String(a.maxWidth))}`],a.fullWidth&&t.paperFullWidth,a.fullScreen&&t.paperFullScreen]}})(ge(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:t})=>!t.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${te.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(t=>t!=="xs").map(t=>({props:{maxWidth:t},style:{maxWidth:`${e.breakpoints.values[t]}${e.breakpoints.unit}`,[`&.${te.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:t})=>t.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:t})=>t.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${te.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ke=p.forwardRef(function(t,a){const s=oe({props:t,name:"MuiDialog"}),r=Ae(),u={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{"aria-describedby":l,"aria-labelledby":o,"aria-modal":d=!0,BackdropComponent:y,BackdropProps:m,children:M,className:b,disableEscapeKeyDown:w=!1,fullScreen:f=!1,fullWidth:g=!1,maxWidth:x="sm",onBackdropClick:F,onClick:S,onClose:c,open:k,PaperComponent:R=me,PaperProps:v={},scroll:j="paper",slots:i={},slotProps:T={},TransitionComponent:C=pe,transitionDuration:P=u,TransitionProps:Q,...Z}=s,N={...s,disableEscapeKeyDown:w,fullScreen:f,fullWidth:g,maxWidth:x,scroll:j},_=Ye(N),H=p.useRef(),ee=W=>{H.current=W.target===W.currentTarget},K=W=>{S&&S(W),H.current&&(H.current=null,F&&F(W),c&&c(W,"backdropClick"))},$=Ne(o),D=p.useMemo(()=>({titleId:$}),[$]),A={transition:C,...i},Te={transition:Q,paper:v,backdrop:m,...T},L={slots:A,slotProps:Te},[ve,Ce]=G("root",{elementType:qe,shouldForwardComponentProp:!0,externalForwardedProps:L,ownerState:N,className:Y(_.root,b),ref:a}),[Me,Se]=G("backdrop",{elementType:ze,shouldForwardComponentProp:!0,externalForwardedProps:L,ownerState:N}),[ke,je]=G("paper",{elementType:Je,shouldForwardComponentProp:!0,externalForwardedProps:L,ownerState:N,className:Y(_.paper,v.className)}),[De,$e]=G("container",{elementType:Xe,externalForwardedProps:L,ownerState:N,className:Y(_.container)}),[Fe,Re]=G("transition",{elementType:pe,externalForwardedProps:L,ownerState:N,additionalProps:{appear:!0,in:k,timeout:P,role:"presentation"}});return n.jsx(ve,{closeAfterTransition:!0,slots:{backdrop:Me},slotProps:{backdrop:{transitionDuration:P,as:y,...Se}},disableEscapeKeyDown:w,onClose:c,open:k,onClick:K,...Ce,...Z,children:n.jsx(Fe,{...Re,children:n.jsx(De,{onMouseDown:ee,...$e,children:n.jsx(ke,{as:R,elevation:24,role:"dialog","aria-describedby":l,"aria-labelledby":$,"aria-modal":d,...je,children:n.jsx(fe.Provider,{value:D,children:M})})})})})});function Ve(e){return re("MuiDialogContent",e)}se("MuiDialogContent",["root","dividers"]);function Qe(e){return re("MuiDialogTitle",e)}const Ze=se("MuiDialogTitle",["root"]),et=e=>{const{classes:t,dividers:a}=e;return ie({root:["root",a&&"dividers"]},Ve,t)},tt=U("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.dividers&&t.dividers]}})(ge(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:t})=>t.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>!t.dividers,style:{[`.${Ze.root} + &`]:{paddingTop:0}}}]}))),nt=p.forwardRef(function(t,a){const s=oe({props:t,name:"MuiDialogContent"}),{className:r,dividers:u=!1,...l}=s,o={...s,dividers:u},d=et(o);return n.jsx(tt,{className:Y(d.root,r),ownerState:o,ref:a,...l})}),at=e=>{const{classes:t}=e;return ie({root:["root"]},Qe,t)},st=U(h,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),rt=p.forwardRef(function(t,a){const s=oe({props:t,name:"MuiDialogTitle"}),{className:r,id:u,...l}=s,o=s,d=at(o),{titleId:y=u}=p.useContext(fe);return n.jsx(st,{component:"h2",className:Y(d.root,r),ownerState:o,ref:a,variant:"h6",id:u??y,...l})}),ot=he(n.jsx("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"}),"ShoppingCart"),it=he(n.jsx("path",{d:"m21.9 8.89-1.05-4.37c-.22-.9-1-1.52-1.91-1.52H5.05c-.9 0-1.69.63-1.9 1.52L2.1 8.89c-.24 1.02-.02 2.06.62 2.88.08.11.19.19.28.29V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6.94c.09-.09.2-.18.28-.28.64-.82.87-1.87.62-2.89m-2.99-3.9 1.05 4.37c.1.42.01.84-.25 1.17-.14.18-.44.47-.94.47-.61 0-1.14-.49-1.21-1.14L16.98 5zM13 5h1.96l.54 4.52c.05.39-.07.78-.33 1.07-.22.26-.54.41-.95.41-.67 0-1.22-.59-1.22-1.31zM8.49 9.52 9.04 5H11v4.69c0 .72-.55 1.31-1.29 1.31-.34 0-.65-.15-.89-.41-.25-.29-.37-.68-.33-1.07m-4.45-.16L5.05 5h1.97l-.58 4.86c-.08.65-.6 1.14-1.21 1.14-.49 0-.8-.29-.93-.47-.27-.32-.36-.75-.26-1.17M5 19v-6.03c.08.01.15.03.23.03.87 0 1.66-.36 2.24-.95.6.6 1.4.95 2.31.95.87 0 1.65-.36 2.23-.93.59.57 1.39.93 2.29.93.84 0 1.64-.35 2.24-.95.58.59 1.37.95 2.24.95.08 0 .15-.02.23-.03V19z"}),"Storefront"),lt=[{inputs:[{internalType:"address",name:"initialOwner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],name:"ERC721IncorrectOwner",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ERC721InsufficientApproval",type:"error"},{inputs:[{internalType:"address",name:"approver",type:"address"}],name:"ERC721InvalidApprover",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"}],name:"ERC721InvalidOperator",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"ERC721InvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"receiver",type:"address"}],name:"ERC721InvalidReceiver",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"ERC721InvalidSender",type:"error"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ERC721NonexistentToken",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_fromTokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"_toTokenId",type:"uint256"}],name:"BatchMetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"MetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"_nextTokenId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"string",name:"metadataURI",type:"string"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"payToMint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function",payable:!0},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"isMinted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"string",name:"uri",type:"string"}],name:"isContentOwned",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function",constant:!0}],xe={abi:lt},B="0x84643357E0de364Acc9659021A1920362e1255D5",be=xe.abi,X="https://gray-magic-tortoise-619.mypinata.cloud/ipfs/",J="http://localhost:8081",ye=async(e,t,a,s,r,u,l,o,d)=>{t(!0),a(null);try{const y=await E.get(`${J}/api/collections/${e}`),{token_id_start:m,creator:M,base_cid:b,nft_count:w}=y.data;s(M),r(w);const f=new le(window.ethereum),g=new de(B,be,f),x=[],F={};for(let S=0;S<w;S++){const c=m+S;try{const k=`${X}${b}/${c}.json`,R=`${X}${b}/${c}.png`,v=await E.get(k,{timeout:1e4}),j=await g.isMinted(c);let i=!1;try{i=(await E.get(`${J}/check-nft-ownership/${c}`,{params:{contractAddress:B,category:e}})).data.isOwned}catch(C){console.warn(`Ownership check failed for ${c}:`,C.message)}const T=j||i;if(F[c]=T,!T){const C={id:c,name:v.data.name||`NFT ${c}`,description:v.data.description||"No description.",image:R,metadata:v.data,isMinted:!1};x.push(C)}}catch(k){console.warn(`Failed to fetch NFT ${c}:`,k.message);continue}}u(x.slice(0,20)),l(x),o(F),d(x,F,w)}catch(y){console.error("Error fetching NFTs:",y),a("Failed to load NFTs for this collection.")}finally{t(!1)}},dt=async(e,t,a,s,r,u,l,o,d)=>{if(!t)return alert("Connect MetaMask first.");if(t.toLowerCase()===(a==null?void 0:a.toLowerCase()))return alert("Creators cannot buy their own NFTs.");const y=localStorage.getItem("jwtToken");if(!y){alert("Please log in to mint NFTs."),r("/login");return}try{if((await E.get(`${J}/check-nft-ownership/${e}`,{params:{contractAddress:B,category:s}})).data.isOwned){alert("This NFT is already owned in this collection.");return}const M=await E.get(`${J}/api/collections/${s}`),{base_cid:b}=M.data,w=new le(window.ethereum),f=await w.getSigner(),g=new de(B,be,f),x=`${X}${b}/${e}.json`;if(await w.getBalance(t)<z("0.06")){alert("Insufficient ETH balance. Need at least 0.06 ETH for minting and gas.");return}if(await g.isMinted(e)){alert(`Token ${e} is already minted on-chain.`);return}if(await g.isContentOwned(x)){alert(`Metadata URI ${x} is already used.`);return}const R=await g.payToMint.estimateGas(t,x,e,{value:z("0.05")})*BigInt(120)/BigInt(100),v=await g.payToMint(t,x,e,{value:z("0.05"),gasLimit:R});alert("Transaction submitted. Waiting for confirmation...");const j=await v.wait(),i=j.gasUsed||BigInt(0),T=j.effectiveGasPrice||BigInt(0),C=i*T,P=ae(C),Q={txHash:j.hash,from:j.from,to:B,amount:"-0.05 ETH",gasUsed:i.toString(),totalGasFee:P},Z=`${X}${b}/${e}.json`,_=(await E.get(Z)).data.name||`NFT ${e}`,H=`${X}${b}/${e}.png`,ee={walletAddress:t,nftId:e,nftName:_,price:"0.05",tokenID:e,contractAddress:B,imageUrl:H,category:s,txHash:Q.txHash,creator:a||null},K=await E.post(`${J}/buy-nft`,ee,{headers:{Authorization:`Bearer ${y}`}}).catch(D=>{var A;throw((A=D.response)==null?void 0:A.status)===401?(alert("Session expired or invalid token. Please log in again."),localStorage.removeItem("jwtToken"),r("/login"),new Error("Unauthorized")):D});if(!K.data.success)throw new Error(`Failed to record NFT purchase: ${K.data.message}`);a&&await f.sendTransaction({to:a,value:z("0.05")}),u(D=>({...D,[e]:!0})),l(D=>D.filter(A=>A.id!==e)),o(D=>D.filter(A=>A.id!==e));const $=JSON.parse(localStorage.getItem(`market_nft_cache_${s}`));return $&&($.nfts=$.nfts.filter(D=>D.id!==e),$.mintedStatus[e]=!0,d($.nfts,$.mintedStatus,$.totalNfts)),alert("NFT minted and recorded successfully!"),window.dispatchEvent(new Event("balanceUpdated")),!0}catch(m){return console.error("Minting error:",m),m.code==="CALL_EXCEPTION"?alert("Minting failed: Transaction reverted. Check token ID, URI, or funds."):alert(`Minting failed: ${m.message||"Unknown error"}`),!1}},we="market_nft_cache",ct=async e=>{if(window.ethereum)try{const t=await window.ethereum.request({method:"eth_accounts"});t.length>0&&e(t[0])}catch(t){console.error("Error checking connection:",t)}},pt=(e,t,a,s,r,u,l)=>{const o=localStorage.getItem(`${we}_${e}`);if(o){const{nfts:d,mintedStatus:y,totalNfts:m,timestamp:M}=JSON.parse(o),b=Date.now()-M,w=24*60*60*1e3;if(b<w){t(d.filter(f=>!y[f.id])),a(d.slice(0,20).filter(f=>!y[f.id])),s(y),r(m),u(!1);return}}l()},ne=(e,t,a,s)=>{const r={nfts:t,mintedStatus:a,totalNfts:s,timestamp:Date.now()};localStorage.setItem(`${we}_${e}`,JSON.stringify(r))},ut=async e=>{if(!window.ethereum)return alert("MetaMask not detected!");try{const t=await window.ethereum.request({method:"eth_requestAccounts"});e(t[0])}catch(t){console.error("MetaMask connection error:",t),alert("Failed to connect to MetaMask.")}},yt=({nft:e,onClick:t})=>n.jsx(q,{item:!0,xs:12,sm:6,md:4,lg:3,children:n.jsx(ce.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},whileHover:{scale:1.03,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.15)"},children:n.jsxs(_e,{sx:{height:"100%",display:"flex",flexDirection:"column",cursor:"pointer",borderRadius:3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",background:"linear-gradient(135deg, #ffffff, #f9f9f9)"},onClick:t,children:[n.jsx(I,{sx:{position:"relative",pt:"100%"},children:n.jsx(He,{component:"img",image:e.image,alt:e.name,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",borderTopLeftRadius:12,borderTopRightRadius:12}})}),n.jsxs(Le,{sx:{flexGrow:1},children:[n.jsx(h,{gutterBottom:!0,variant:"h6",component:"h2",sx:{fontWeight:"bold",color:"#2c3e50"},children:e.name}),n.jsx(h,{variant:"body2",sx:{color:"#7f8c8d",mb:2},children:e.description}),n.jsxs(h,{variant:"caption",display:"block",color:"text.secondary",children:["Token ID: ",e.id]})]})]})})}),mt="0x84643357E0de364Acc9659021A1920362e1255D5",gt=xe.abi,ht="https://gray-magic-tortoise-619.mypinata.cloud/ipfs/",ft=({open:e,onClose:t,nft:a,account:s,creator:r,collectionName:u,mintNFT:l,mintedStatus:o})=>{const[d,y]=p.useState(null),[m,M]=p.useState(null);p.useEffect(()=>{e&&s&&b()},[e,s]);const b=async()=>{try{const g=new le(window.ethereum),x=await g.getSigner(),F=new de(mt,gt,x),S=await g.getBalance(s),c=ae(S);y(c);const k=`${ht}${a.base_cid}/${a.id}.json`,R=await F.payToMint.estimateGas(s,k,a.id,{value:z("0.05")});let v;try{v=(await g.getFeeData()).gasPrice||ue("2","gwei")}catch(T){console.warn("Failed to fetch fee data, using default gas price:",T.message),v=ue("2","gwei")}const j=R*v,i=ae(j);M(i)}catch(g){console.error("Error fetching balance/gas:",g),y("Error"),M("Error")}},w=async()=>{await l(a.id)&&t()},f=r&&r!=="Unknown"?r:"Anonymous";return n.jsx(Ke,{open:e,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.15)",background:"linear-gradient(135deg, #ffffff, #f0f4ff)"}},children:n.jsxs(ce.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[n.jsx(rt,{sx:{bgcolor:"#6e8efb",color:"white",fontWeight:"bold",borderTopLeftRadius:12,borderTopRightRadius:12},children:a.name}),n.jsx(nt,{sx:{p:4},children:n.jsxs(q,{container:!0,spacing:3,children:[n.jsx(q,{item:!0,xs:12,md:6,children:n.jsx(I,{sx:{position:"relative",pt:"100%",borderRadius:2,overflow:"hidden",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:n.jsx("img",{src:a.image,alt:a.name,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsxs(q,{item:!0,xs:12,md:6,children:[n.jsx(h,{variant:"h6",sx:{fontWeight:"bold",color:"#2c3e50",mb:2},children:"Details"}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Name:"})," ",a.name]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Description:"})," ",a.description]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Token ID:"})," ",a.id]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Price:"})," 0.05 ETH"]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Gas Estimate:"})," ",m?`${parseFloat(m).toFixed(6)} ETH`:"Calculating..."]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Current Balance:"})," ",d?`${parseFloat(d).toFixed(6)} ETH`:"Fetching..."]}),n.jsxs(h,{sx:{color:"#27ae60"},children:[n.jsx("strong",{children:"Balance After:"})," ",d&&m?(parseFloat(d)-.05-parseFloat(m)).toFixed(6)+" ETH":"N/A"]}),n.jsxs(h,{sx:{color:"#34495e"},children:[n.jsx("strong",{children:"Creator:"})," ",f]}),n.jsx(I,{sx:{mt:3},children:n.jsx(V,{variant:"contained",fullWidth:!0,onClick:w,disabled:!s||o[a.id],sx:{background:"linear-gradient(90deg, #6e8efb, #a777e3)","&:hover":{background:"linear-gradient(90deg, #5d78e6, #9366d2)"},"&:disabled":{bgcolor:"#bdc3c7"},borderRadius:2,py:1.5},startIcon:n.jsx(ot,{}),children:o[a.id]?"Minted/Owned":"Buy NFT (0.05 ETH)"})})]})]})})]})})},Tt=()=>{const{collectionName:e}=Pe(),t=We(),{state:a}=Be(),[s,r]=p.useState([]),[u,l]=p.useState([]),[o,d]=p.useState(null),[y,m]=p.useState(!0),[M,b]=p.useState(null),[w,f]=p.useState({}),[g,x]=p.useState(null),[F,S]=p.useState(0),[c,k]=p.useState(null);p.useEffect(()=>{ct(d),pt(e,l,r,f,S,m,()=>ye(e,m,b,x,S,r,l,f,(i,T,C)=>ne(e,i,T,C)))},[e]);const R=()=>{r(u)},v=i=>{k(i)},j=i=>dt(i,o,g,e,t,f,r,l,(T,C,P)=>ne(e,T,C,P));return n.jsx(Oe,{maxWidth:"lg",sx:{mt:6,mb:4},children:n.jsxs(ce.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8},children:[n.jsxs(I,{sx:{background:"linear-gradient(135deg, #6e8efb, #a777e3)",borderRadius:3,p:4,textAlign:"center",color:"white",mb:4,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)"},children:[n.jsxs(h,{variant:"h3",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[n.jsx(it,{})," ",e," Collection"]}),n.jsx(h,{variant:"body1",sx:{mb:2},children:"Discover and mint unique NFTs from this collection."}),n.jsxs(I,{sx:{display:"flex",justifyContent:"center",gap:2},children:[o?n.jsxs(h,{variant:"body1",sx:{bgcolor:"rgba(255, 255, 255, 0.2)",p:1,borderRadius:1},children:["Connected: ",o.substring(0,6),"...",o.substring(o.length-4)]}):n.jsx(V,{variant:"contained",color:"secondary",onClick:()=>ut(d),sx:{borderRadius:2},children:"Connect MetaMask"}),n.jsx(V,{variant:"outlined",sx:{color:"white",borderColor:"white","&:hover":{borderColor:"#dcdcdc",bgcolor:"rgba(255, 255, 255, 0.1)"},borderRadius:2},onClick:()=>ye(e,m,b,x,S,r,l,f,(i,T,C)=>ne(e,i,T,C)),children:"Refresh NFTs"})]})]}),y?n.jsx(I,{sx:{display:"flex",justifyContent:"center",my:4},children:n.jsx(Ue,{color:"primary"})}):M?n.jsx(h,{color:"error",align:"center",sx:{fontSize:"1.2rem",fontWeight:"bold"},children:M}):s.length===0?n.jsx(h,{align:"center",sx:{color:"#7f8c8d",fontSize:"1.2rem"},children:"No available NFTs in this collection."}):n.jsxs(n.Fragment,{children:[n.jsx(q,{container:!0,spacing:4,children:s.map(i=>n.jsx(yt,{nft:i,onClick:()=>v(i)},i.id))}),s.length<u.length&&n.jsx(I,{sx:{display:"flex",justifyContent:"center",mt:4},children:n.jsxs(V,{variant:"contained",onClick:R,sx:{background:"linear-gradient(90deg, #6e8efb, #a777e3)","&:hover":{background:"linear-gradient(90deg, #5d78e6, #9366d2)"},borderRadius:2,py:1.5},children:["Load All (",u.length-s.length," remaining)"]})})]}),c&&n.jsx(ft,{open:!!c,onClose:()=>k(null),nft:c,account:o,creator:g,collectionName:e,mintNFT:j,mintedStatus:w})]})})};export{Tt as default};
